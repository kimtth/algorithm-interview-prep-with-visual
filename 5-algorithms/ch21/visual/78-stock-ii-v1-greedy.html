<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Best Time to Buy/Sell Stock II - Greedy</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; }
        h1 { text-align: center; color: white; margin-bottom: 10px; }
        .subtitle { text-align: center; color: rgba(255,255,255,0.9); margin-bottom: 20px; font-size: 14px; }
        .controls { display: flex; justify-content: center; gap: 15px; margin-bottom: 20px; }
        button { background: white; color: #667eea; border: none; padding: 10px 25px; border-radius: 25px; cursor: pointer; font-weight: 600; }
        button:disabled { opacity: 0.5; cursor: not-allowed; }
        .panel { background: white; border-radius: 15px; padding: 20px; margin-bottom: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        .panel-title { font-size: 16px; font-weight: bold; color: #333; margin-bottom: 15px; border-bottom: 2px solid #667eea; padding-bottom: 10px; }
        #chart { width: 100%; height: 300px; }
        .profit-display { display: flex; justify-content: center; gap: 30px; margin-top: 20px; }
        .profit-item { text-align: center; padding: 15px 30px; background: #f5f7fa; border-radius: 10px; }
        .profit-label { font-size: 12px; color: #666; }
        .profit-value { font-size: 28px; font-weight: bold; color: #667eea; }
        .profit-value.positive { color: #4caf50; }
        .profit-value.negative { color: #f44336; }
        .status-box { background: #f5f7fa; border-radius: 10px; padding: 15px; font-family: monospace; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìà Best Time to Buy and Sell Stock II</h1>
        <p class="subtitle">Greedy O(n) - Capture every positive price difference</p>

        <div class="controls">
            <button id="stepBtn">Step</button>
            <button id="autoBtn">Auto Run</button>
            <button id="resetBtn">Reset</button>
        </div>

        <div class="panel">
            <div class="panel-title">üìä Stock Prices</div>
            <div id="chart"></div>
            <div class="profit-display">
                <div class="profit-item">
                    <div class="profit-label">Current Diff</div>
                    <div class="profit-value" id="current-diff">0</div>
                </div>
                <div class="profit-item">
                    <div class="profit-label">Total Profit</div>
                    <div class="profit-value positive" id="total-profit">0</div>
                </div>
            </div>
        </div>

        <div class="panel">
            <div class="panel-title">üìã Status</div>
            <div class="status-box" id="status">Greedy: Add (prices[i] - prices[i-1]) if positive. This equals buying before every rise and selling at the peak.</div>
        </div>
    </div>

    <script>
        const prices = [7, 1, 5, 3, 6, 4];
        let idx = 1;
        let profit = 0;
        let done = false;
        let autoInterval = null;
        let gains = [];

        const margin = { top: 30, right: 30, bottom: 40, left: 50 };
        const width = 800 - margin.left - margin.right;
        const height = 300 - margin.top - margin.bottom;

        const svg = d3.select("#chart")
            .append("svg")
            .attr("viewBox", `0 0 ${width + margin.left + margin.right} ${height + margin.top + margin.bottom}`)
            .append("g")
            .attr("transform", `translate(${margin.left},${margin.top})`);

        const x = d3.scaleLinear().domain([0, prices.length - 1]).range([0, width]);
        const y = d3.scaleLinear().domain([0, d3.max(prices) + 1]).range([height, 0]);

        svg.append("g").attr("transform", `translate(0,${height})`).call(d3.axisBottom(x).ticks(prices.length).tickFormat(d => `Day ${d}`));
        svg.append("g").call(d3.axisLeft(y));

        const line = d3.line().x((d, i) => x(i)).y(d => y(d));

        svg.append("path")
            .datum(prices)
            .attr("fill", "none")
            .attr("stroke", "#667eea")
            .attr("stroke-width", 3)
            .attr("d", line);

        svg.selectAll(".dot")
            .data(prices)
            .enter().append("circle")
            .attr("class", "dot")
            .attr("cx", (d, i) => x(i))
            .attr("cy", d => y(d))
            .attr("r", 8)
            .attr("fill", "#667eea");

        svg.selectAll(".label")
            .data(prices)
            .enter().append("text")
            .attr("x", (d, i) => x(i))
            .attr("y", d => y(d) - 15)
            .attr("text-anchor", "middle")
            .attr("font-weight", "bold")
            .attr("fill", "#333")
            .text(d => `$${d}`);

        function render() {
            // Highlight segments
            svg.selectAll(".segment").remove();
            
            for (let i = 0; i < gains.length; i++) {
                const g = gains[i];
                svg.append("line")
                    .attr("class", "segment")
                    .attr("x1", x(g.from))
                    .attr("y1", y(prices[g.from]))
                    .attr("x2", x(g.to))
                    .attr("y2", y(prices[g.to]))
                    .attr("stroke", g.profit > 0 ? "#4caf50" : "#f44336")
                    .attr("stroke-width", 5)
                    .attr("opacity", 0.7);
            }

            // Update current comparison
            if (idx < prices.length) {
                const diff = prices[idx] - prices[idx - 1];
                document.getElementById('current-diff').textContent = diff > 0 ? `+${diff}` : diff;
                document.getElementById('current-diff').className = `profit-value ${diff > 0 ? 'positive' : 'negative'}`;
            }
            
            document.getElementById('total-profit').textContent = profit;
        }

        function step() {
            if (done) return;

            if (idx >= prices.length) {
                done = true;
                document.getElementById('status').innerHTML = 
                    `‚úÖ Done! Maximum profit: $${profit}`;
                document.getElementById('stepBtn').disabled = true;
                document.getElementById('autoBtn').disabled = true;
                document.getElementById('current-diff').textContent = '-';
                stopAuto();
                return;
            }

            const diff = prices[idx] - prices[idx - 1];
            gains.push({ from: idx - 1, to: idx, profit: diff > 0 ? diff : 0 });

            if (diff > 0) {
                profit += diff;
                document.getElementById('status').innerHTML = 
                    `Day ${idx - 1} ‚Üí ${idx}: $${prices[idx - 1]} ‚Üí $${prices[idx]}. Gain +$${diff}. Total profit: $${profit}`;
            } else {
                document.getElementById('status').innerHTML = 
                    `Day ${idx - 1} ‚Üí ${idx}: $${prices[idx - 1]} ‚Üí $${prices[idx]}. Loss ${diff}. Skip (no trade).`;
            }

            idx++;
            render();
        }

        function reset() {
            stopAuto();
            idx = 1;
            profit = 0;
            gains = [];
            done = false;
            document.getElementById('stepBtn').disabled = false;
            document.getElementById('autoBtn').disabled = false;
            document.getElementById('status').innerHTML = 'Greedy: Add (prices[i] - prices[i-1]) if positive. This equals buying before every rise and selling at the peak.';
            document.getElementById('current-diff').textContent = '0';
            document.getElementById('current-diff').className = 'profit-value';
            render();
        }

        function stopAuto() {
            if (autoInterval) { clearInterval(autoInterval); autoInterval = null; }
            document.getElementById('autoBtn').textContent = 'Auto Run';
        }

        document.getElementById('stepBtn').onclick = () => { stopAuto(); step(); };
        document.getElementById('autoBtn').onclick = () => {
            if (autoInterval) { stopAuto(); }
            else { autoInterval = setInterval(step, 800); document.getElementById('autoBtn').textContent = '‚è∏ Pause'; }
        };
        document.getElementById('resetBtn').onclick = reset;

        render();
    </script>
</body>
</html>
