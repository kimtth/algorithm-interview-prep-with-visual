<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sum of Two Integers - Bit Manipulation</title>
    <link rel="stylesheet" href="visual.css">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    
</head>
<body>
    <div class="container">
        <h1>‚ûï Sum of Two Integers (No + or -)</h1>
        <p class="subtitle">Bit Manipulation - XOR for sum, AND+shift for carry</p>

        <div class="controls">
            <button id="stepBtn">Step</button>
            <button id="autoBtn">Auto Run</button>
            <button id="resetBtn">Reset</button>
        </div>

        <div class="panel">
            <div class="panel-title">üî¢ Iteration <span id="iter-num">0</span></div>
            <div id="binary-display"></div>
            <div class="formula" id="formula">a + b = (a XOR b) + (a AND b) << 1</div>
        </div>

        <div class="panel">
            <div class="panel-title">üìä Result</div>
            <div class="result-box">
                <div class="result-value"><span id="a-init">1</span> + <span id="b-init">2</span> = <span id="result">?</span></div>
            </div>
        </div>

        <div class="panel">
            <div class="panel-title">üìã Status</div>
            <div class="status-box" id="status">XOR gives sum without carry. AND+shift gives carry. Repeat until no carry.</div>
        </div>
    
        <div class="code-section">
            <h3>üìÑ Python Solution (72-1.py)</h3>
            <pre><span class="keyword">class</span> Solution:
    <span class="keyword">def</span> <span class="function">getSum</span>(<span class="keyword">self</span>, a: int, b: int) -&gt; int:
        MASK = 0xFFFFFFFF
        INT_MAX = 0x7FFFFFFF

        a_bin = <span class="function">bin</span>(a &amp; MASK)[<span class="number">2</span>:].<span class="function">zfill</span>(<span class="number">32</span>)
        b_bin = <span class="function">bin</span>(b &amp; MASK)[<span class="number">2</span>:].<span class="function">zfill</span>(<span class="number">32</span>)

        result = []
        carry = <span class="number">0</span>
        sum = <span class="number">0</span>
        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="function">range</span>(<span class="number">32</span>):
            A = <span class="function">int</span>(a_bin[<span class="number">31</span> - i])
            B = <span class="function">int</span>(b_bin[<span class="number">31</span> - i])

            <span class="comment"># Ï†ÑÍ∞ÄÏÇ∞Í∏∞ Íµ¨ÌòÑ</span>
            Q1 = A &amp; B
            Q2 = A ^ B
            Q3 = Q2 &amp; carry
            sum = carry ^ Q2
            carry = Q1 | Q3

            result.<span class="function">append</span>(<span class="function">str</span>(sum))
        <span class="keyword">if</span> carry == <span class="number">1</span>:
            result.<span class="function">append</span>('<span class="number">1</span>')

        <span class="comment"># Ï¥àÍ≥º ÏûêÎ¶øÏàò Ï≤òÎ¶¨</span>
        result = <span class="function">int</span>(''.<span class="function">join</span>(result[::-<span class="number">1</span>]), <span class="number">2</span>) &amp; MASK
        <span class="comment"># ÏùåÏàò Ï≤òÎ¶¨</span>
        <span class="keyword">if</span> result &gt; INT_MAX:
            result = ~(result ^ MASK)

        <span class="keyword">return</span> result</pre>
        </div>

    </div>


    <script>
        const INIT_A = 1, INIT_B = 2;
        const BITS = 8;
        let a = INIT_A, b = INIT_B;
        let iteration = 0;
        let done = false;
        let autoInterval = null;

        document.getElementById('a-init').textContent = INIT_A;
        document.getElementById('b-init').textContent = INIT_B;

        function toBits(n) {
            return ((n >>> 0) & 0xFF).toString(2).padStart(BITS, '0').split('');
        }

        function render() {
            document.getElementById('iter-num').textContent = iteration;

            const display = document.getElementById('binary-display');
            const aBits = toBits(a);
            const bBits = toBits(b);

            let html = `
                <div class="binary-row">
                    <span class="binary-label">a:</span>
                    <div class="bits-container">${aBits.map(bit => `<div class="bit bit-${bit}">${bit}</div>`).join('')}</div>
                    <span class="decimal">= ${a}</span>
                </div>
                <div class="binary-row">
                    <span class="binary-label">b (carry):</span>
                    <div class="bits-container">${bBits.map(bit => `<div class="bit ${bit === '1' ? 'bit-carry' : 'bit-0'}">${bit}</div>`).join('')}</div>
                    <span class="decimal">= ${b}</span>
                </div>
            `;

            if (!done && b !== 0) {
                const xorBits = toBits(a ^ b);
                const andBits = toBits((a & b) << 1);
                html += `
                    <div class="divider"></div>
                    <div class="binary-row">
                        <span class="binary-label">a XOR b:</span>
                        <div class="bits-container">${xorBits.map(bit => `<div class="bit bit-${bit}">${bit}</div>`).join('')}</div>
                        <span class="decimal">= ${a ^ b}</span>
                    </div>
                    <div class="binary-row">
                        <span class="binary-label">(a AND b) << 1:</span>
                        <div class="bits-container">${andBits.map(bit => `<div class="bit ${bit === '1' ? 'bit-carry' : 'bit-0'}">${bit}</div>`).join('')}</div>
                        <span class="decimal">= ${(a & b) << 1}</span>
                    </div>
                `;
            }

            display.innerHTML = html;
            document.getElementById('result').textContent = done ? a : '?';
        }

        function step() {
            if (done) return;

            if (b === 0) {
                done = true;
                document.getElementById('formula').textContent = `Carry is 0! Result = ${a}`;
                document.getElementById('status').innerHTML = `‚úÖ No more carry! ${INIT_A} + ${INIT_B} = ${a}`;
                document.getElementById('stepBtn').disabled = true;
                document.getElementById('autoBtn').disabled = true;
                stopAuto();
                render();
                return;
            }

            const newA = a ^ b;
            const newB = (a & b) << 1;
            
            document.getElementById('status').innerHTML = 
                `Iteration ${iteration + 1}: a=${a} XOR b=${b} ‚Üí ${newA}, carry=(${a} AND ${b})<<1 ‚Üí ${newB}`;

            a = newA;
            b = newB;
            iteration++;

            render();
        }

        function reset() {
            stopAuto();
            a = INIT_A;
            b = INIT_B;
            iteration = 0;
            done = false;
            document.getElementById('formula').textContent = 'a + b = (a XOR b) + (a AND b) << 1';
            document.getElementById('stepBtn').disabled = false;
            document.getElementById('autoBtn').disabled = false;
            document.getElementById('status').innerHTML = 'XOR gives sum without carry. AND+shift gives carry. Repeat until no carry.';
            render();
        }

        function stopAuto() {
            if (autoInterval) { clearInterval(autoInterval); autoInterval = null; }
            document.getElementById('autoBtn').textContent = 'Auto Run';
        }

        document.getElementById('stepBtn').onclick = () => { stopAuto(); step(); };
        document.getElementById('autoBtn').onclick = () => {
            if (autoInterval) { stopAuto(); }
            else { autoInterval = setInterval(step, 1000); document.getElementById('autoBtn').textContent = '‚è∏ Pause'; }
        };
        document.getElementById('resetBtn').onclick = reset;

        render();
    </script>
</body>
</html>
