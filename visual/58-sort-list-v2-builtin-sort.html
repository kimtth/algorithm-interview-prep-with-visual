<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sort List - Built-in Sort</title>
    <link rel="stylesheet" href="visual.css">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    
</head>
<body>
    <div class="container">
        <h1>üîó Sort List - Built-in Sort</h1>
        <p class="subtitle">O(n log n) using Python list and built-in sort</p>

        <div class="controls">
            <button id="stepBtn">Step</button>
            <button id="autoBtn">Auto Run</button>
            <button id="resetBtn">Reset</button>
        </div>

        <div class="step-indicator">
            <div class="step-item" id="step1">1. Convert to List</div>
            <div class="step-item" id="step2">2. Sort</div>
            <div class="step-item" id="step3">3. Convert Back</div>
        </div>

        <div class="panel">
            <div class="panel-title">üîó Linked List</div>
            <div class="list-container" id="linked-list"></div>
        </div>

        <div class="panel">
            <div class="panel-title">üìù Python List</div>
            <div class="python-list" id="python-list">
                <span class="bracket">[</span>
                <span id="list-content">-</span>
                <span class="bracket">]</span>
            </div>
        </div>

        <div class="panel">
            <div class="panel-title">üìä Status</div>
            <div class="status-box" id="status">Click "Step" or "Auto Run" to start</div>
        </div>

        <div class="panel">
            <div class="panel-title">üíª Algorithm</div>
            <div class="code-box" id="code">
<span id="line1">def sortList(head):</span>
<span id="line2">    # Convert Linked List to Python List</span>
<span id="line3">    p = head</span>
<span id="line4">    lst = []</span>
<span id="line5">    while p:</span>
<span id="line6">        lst.append(p.val)</span>
<span id="line7">        p = p.next</span>
<span id="line8">    </span>
<span id="line9">    # Sort using built-in</span>
<span id="line10">    lst.sort()</span>
<span id="line11">    </span>
<span id="line12">    # Convert back to Linked List</span>
<span id="line13">    p = head</span>
<span id="line14">    for i in range(len(lst)):</span>
<span id="line15">        p.val = lst[i]</span>
<span id="line16">        p = p.next</span>
<span id="line17">    return head</span>
            </div>
        </div>

        <div class="code-section">
            <h3>üìÑ Python Solution (58-3.py)</h3>
            <pre><span class="keyword">from</span> typing <span class="keyword">import</span> List


<span class="comment"># Definition for singly-linked list.</span>
<span class="keyword">class</span> ListNode:
    <span class="keyword">def</span> <span class="function">__init__</span>(<span class="keyword">self</span>, x):
        <span class="keyword">self</span>.val = x
        <span class="keyword">self</span>.next = <span class="keyword">None</span>


<span class="keyword">class</span> Solution:
    <span class="keyword">def</span> <span class="function">sortList</span>(<span class="keyword">self</span>, head: ListNode) -&gt; ListNode:
        <span class="comment"># Ïó∞Í≤∞ Î¶¨Ïä§Ìä∏ -> ÌååÏù¥Ïç¨ Î¶¨Ïä§Ìä∏</span>
        p = head
        lst: List = []
        <span class="keyword">while</span> p:
            lst.<span class="function">append</span>(p.val)
            p = p.next

        <span class="comment"># Ï†ïÎ†¨</span>
        lst.<span class="function">sort</span>()

        <span class="comment"># ÌååÏù¥Ïç¨ Î¶¨Ïä§Ìä∏ -> Ïó∞Í≤∞ Î¶¨Ïä§Ìä∏</span>
        p = head
        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="function">range</span>(<span class="function">len</span>(lst)):
            p.val = lst[i]
            p = p.next
        <span class="keyword">return</span> head</pre>
        </div>
    </div>

    <script>
        const initialList = [4, 2, 1, 3, 5, 6];
        let linkedList = [...initialList];
        let pythonList = [];
        let step = 0;
        let phase = 0; // 0: convert, 1: sort, 2: convert back
        let convertIndex = 0;
        let autoInterval = null;

        function renderLinkedList() {
            const container = document.getElementById('linked-list');
            container.innerHTML = '';
            
            linkedList.forEach((val, i) => {
                const node = document.createElement('div');
                node.className = 'node';
                node.innerHTML = `<div class="node-box" id="ll-node-${i}">${val}</div>`;
                container.appendChild(node);
                
                if (i < linkedList.length - 1) {
                    const arrow = document.createElement('div');
                    arrow.className = 'arrow';
                    arrow.textContent = '‚Üí';
                    container.appendChild(arrow);
                }
            });
        }

        function renderPythonList() {
            const content = document.getElementById('list-content');
            if (pythonList.length === 0) {
                content.innerHTML = '-';
            } else {
                content.innerHTML = pythonList.map((v, i) => 
                    `<span class="list-item" id="py-item-${i}">${v}</span>`
                ).join(', ');
            }
        }

        function updateStepIndicator() {
            for (let i = 1; i <= 3; i++) {
                const el = document.getElementById(`step${i}`);
                el.classList.remove('active', 'done');
                if (i < phase + 1) el.classList.add('done');
                else if (i === phase + 1) el.classList.add('active');
            }
        }

        function highlightCode(lineNum) {
            document.querySelectorAll('.code-box span').forEach(span => {
                span.classList.remove('highlight');
            });
            if (lineNum) {
                const line = document.getElementById(`line${lineNum}`);
                if (line) line.classList.add('highlight');
            }
        }

        function executeStep() {
            if (phase === 0) {
                // Convert to Python list
                if (convertIndex < linkedList.length) {
                    pythonList.push(linkedList[convertIndex]);
                    
                    highlightCode(6);
                    renderPythonList();
                    
                    const node = document.getElementById(`ll-node-${convertIndex}`);
                    if (node) node.classList.add('active');
                    
                    document.getElementById('status').innerHTML = 
                        `Append node[${convertIndex}].val = ${linkedList[convertIndex]} to Python list`;
                    
                    convertIndex++;
                } else {
                    phase = 1;
                    updateStepIndicator();
                    highlightCode(10);
                    
                    // Sort the python list
                    pythonList.sort((a, b) => a - b);
                    renderPythonList();
                    
                    // Highlight all as sorted
                    pythonList.forEach((_, i) => {
                        const item = document.getElementById(`py-item-${i}`);
                        if (item) item.classList.add('sorted');
                    });
                    
                    document.getElementById('status').innerHTML = 
                        `Sort Python list: [${pythonList.join(', ')}]`;
                    
                    convertIndex = 0;
                }
            } else if (phase === 1) {
                phase = 2;
                updateStepIndicator();
                convertIndex = 0;
                executeStep();
                return;
            } else if (phase === 2) {
                // Convert back to linked list
                if (convertIndex < pythonList.length) {
                    linkedList[convertIndex] = pythonList[convertIndex];
                    
                    highlightCode(15);
                    renderLinkedList();
                    
                    const node = document.getElementById(`ll-node-${convertIndex}`);
                    if (node) {
                        node.classList.add('converted');
                    }
                    
                    document.getElementById('status').innerHTML = 
                        `Set node[${convertIndex}].val = ${pythonList[convertIndex]}`;
                    
                    convertIndex++;
                } else {
                    highlightCode(17);
                    document.getElementById('status').innerHTML = 
                        '‚úÖ Sort complete! Linked list is now sorted.';
                    document.getElementById('stepBtn').disabled = true;
                    document.getElementById('autoBtn').disabled = true;
                    stopAuto();
                    
                    // Mark all nodes as converted
                    linkedList.forEach((_, i) => {
                        const node = document.getElementById(`ll-node-${i}`);
                        if (node) node.classList.add('converted');
                    });
                }
            }
        }

        function reset() {
            stopAuto();
            linkedList = [...initialList];
            pythonList = [];
            step = 0;
            phase = 0;
            convertIndex = 0;
            
            document.getElementById('stepBtn').disabled = false;
            document.getElementById('autoBtn').disabled = false;
            document.getElementById('status').innerHTML = 'Click "Step" or "Auto Run" to start';
            
            highlightCode(null);
            updateStepIndicator();
            renderLinkedList();
            renderPythonList();
        }

        function stopAuto() {
            if (autoInterval) {
                clearInterval(autoInterval);
                autoInterval = null;
                document.getElementById('autoBtn').textContent = 'Auto Run';
            }
        }

        document.getElementById('stepBtn').addEventListener('click', () => {
            stopAuto();
            executeStep();
        });

        document.getElementById('autoBtn').addEventListener('click', () => {
            if (autoInterval) {
                stopAuto();
            } else {
                autoInterval = setInterval(executeStep, 600);
                document.getElementById('autoBtn').textContent = '‚è∏ Pause';
            }
        });

        document.getElementById('resetBtn').addEventListener('click', reset);

        // Initialize
        updateStepIndicator();
        renderLinkedList();
        renderPythonList();
    </script>
</body>
</html>
