<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Number of 1 Bits - Brian Kernighan</title>
    <link rel="stylesheet" href="visual.css">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    
</head>
<body>
    <div class="container">
        <h1>ğŸ”¢ Number of 1 Bits (Hamming Weight)</h1>
        <p class="subtitle">Brian Kernighan's Algorithm - n & (n-1) removes rightmost 1</p>

        <div class="controls">
            <button id="stepBtn">Step</button>
            <button id="autoBtn">Auto Run</button>
            <button id="resetBtn">Reset</button>
        </div>

        <div class="panel">
            <div class="panel-title">ğŸ”¢ Binary Representation</div>
            <div class="binary-display">
                <div class="binary-row">
                    <span class="binary-label">n:</span>
                    <div class="bits-container" id="bits-n"></div>
                    <span class="decimal" id="decimal-n">= 11</span>
                </div>
                <div class="binary-row" id="row-n1" class="d-none">
                    <span class="binary-label">n - 1:</span>
                    <div class="bits-container" id="bits-n1"></div>
                    <span class="decimal" id="decimal-n1"></span>
                </div>
            </div>
            <div class="formula" id="formula">n & (n-1) removes the rightmost set bit</div>
        </div>

        <div class="panel">
            <div class="panel-title">ğŸ“Š Count of 1 Bits</div>
            <div class="count-display">
                <div class="count-value" id="count">0</div>
                <div class="count-label">Hamming Weight</div>
            </div>
        </div>

        <div class="panel">
            <div class="panel-title">ğŸ“‹ Status</div>
            <div class="status-box" id="status">Each iteration removes the rightmost 1 bit. Count iterations until n = 0.</div>
        </div>
    
        <div class="code-section">
            <h3>ğŸ“„ Python Solution (74-1.py)</h3>
            <pre><span class="keyword">class</span> Solution:
    <span class="keyword">def</span> <span class="function">hammingWeight</span>(<span class="keyword">self</span>, n: int) -&gt; int:
        <span class="keyword">return</span> <span class="function">bin</span>(n).<span class="function">count</span>('<span class="number">1</span>')</pre>
        </div>

    </div>


    <script>
        const INIT_N = 11;  // 00001011 - has 3 ones
        const BITS = 8;
        let n = INIT_N;
        let count = 0;
        let showN1 = false;
        let done = false;
        let autoInterval = null;

        function toBits(num) {
            return ((num >>> 0) & 0xFF).toString(2).padStart(BITS, '0').split('');
        }

        function render() {
            const nBits = toBits(n);
            document.getElementById('bits-n').innerHTML = nBits.map(b => 
                `<div class="bit bit-${b}">${b}</div>`
            ).join('');
            document.getElementById('decimal-n').textContent = `= ${n}`;

            if (showN1 && n > 0) {
                const n1 = n - 1;
                const n1Bits = toBits(n1);
                document.getElementById('row-n1').style.display = 'flex';
                document.getElementById('bits-n1').innerHTML = n1Bits.map(b => 
                    `<div class="bit bit-${b}">${b}</div>`
                ).join('');
                document.getElementById('decimal-n1').textContent = `= ${n1}`;
            } else {
                document.getElementById('row-n1').style.display = 'none';
            }

            document.getElementById('count').textContent = count;
        }

        function step() {
            if (done) return;

            if (n === 0) {
                done = true;
                document.getElementById('formula').textContent = `n = 0, done!`;
                document.getElementById('status').innerHTML = 
                    `âœ… Hamming Weight of ${INIT_N} is ${count}`;
                document.getElementById('stepBtn').disabled = true;
                document.getElementById('autoBtn').disabled = true;
                showN1 = false;
                stopAuto();
                render();
                return;
            }

            if (!showN1) {
                showN1 = true;
                document.getElementById('status').innerHTML = 
                    `n = ${n}, n-1 = ${n-1}. n & (n-1) will remove rightmost 1.`;
            } else {
                const oldN = n;
                n = n & (n - 1);
                count++;
                showN1 = false;
                document.getElementById('status').innerHTML = 
                    `${oldN} & ${oldN - 1} = ${n}. Removed one 1-bit. Count = ${count}`;
            }

            render();
        }

        function reset() {
            stopAuto();
            n = INIT_N;
            count = 0;
            showN1 = false;
            done = false;
            document.getElementById('formula').textContent = 'n & (n-1) removes the rightmost set bit';
            document.getElementById('stepBtn').disabled = false;
            document.getElementById('autoBtn').disabled = false;
            document.getElementById('status').innerHTML = 'Each iteration removes the rightmost 1 bit. Count iterations until n = 0.';
            render();
        }

        function stopAuto() {
            if (autoInterval) { clearInterval(autoInterval); autoInterval = null; }
            document.getElementById('autoBtn').textContent = 'Auto Run';
        }

        document.getElementById('stepBtn').onclick = () => { stopAuto(); step(); };
        document.getElementById('autoBtn').onclick = () => {
            if (autoInterval) { stopAuto(); }
            else { autoInterval = setInterval(step, 800); document.getElementById('autoBtn').textContent = 'â¸ Pause'; }
        };
        document.getElementById('resetBtn').onclick = reset;

        render();
    </script>
</body>
</html>
